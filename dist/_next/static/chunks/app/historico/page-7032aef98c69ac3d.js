(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[239],{6219:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>y});var t=a(5155),r=a(6639),l=a(8145),i=a(7168),n=a(8482),c=a(2115),o=a(2473),d=a(3999);function m(e){let{className:s,...a}=e;return(0,t.jsx)(o.bL,{"data-slot":"tabs",className:(0,d.cn)("flex flex-col gap-2",s),...a})}function u(e){let{className:s,...a}=e;return(0,t.jsx)(o.B8,{"data-slot":"tabs-list",className:(0,d.cn)("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",s),...a})}function x(e){let{className:s,...a}=e;return(0,t.jsx)(o.l9,{"data-slot":"tabs-trigger",className:(0,d.cn)("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",s),...a})}function h(e){let{className:s,...a}=e;return(0,t.jsx)(o.UC,{"data-slot":"tabs-content",className:(0,d.cn)("flex-1 outline-none",s),...a})}var f=a(5328),p=a(7550),g=a(6740),j=a(7434),N=a(2525),v=a(6874),b=a.n(v);function y(){let[e,s]=(0,c.useState)([]),[a,o]=(0,c.useState)([]),[d,v]=(0,c.useState)(!0),y=(0,c.useRef)(null);(0,c.useEffect)(()=>{y.current&&y.current.focus(),w()},[]);let w=async()=>{try{let[e,a]=await Promise.all([f.db.getAllClosings(),f.db.getAllCalculations()]);s(e.sort((e,s)=>s.date.getTime()-e.date.getTime())),o(a.sort((e,s)=>s.date.getTime()-e.date.getTime()))}catch(e){console.error("Erro ao carregar hist\xf3rico:",e)}finally{v(!1)}},k=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e/100),C=e=>new Intl.DateTimeFormat("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(e),E=async a=>{if(confirm("Tem certeza que deseja excluir este fechamento?"))try{await f.db.deleteClosing(a),s(e.filter(e=>e.id!==a))}catch(e){console.error("Erro ao excluir fechamento:",e),alert("Erro ao excluir fechamento.")}},A=async e=>{if(confirm("Tem certeza que deseja excluir este c\xe1lculo?"))try{await f.db.deleteCalculation(e),o(a.filter(s=>s.id!==e))}catch(e){console.error("Erro ao excluir c\xe1lculo:",e),alert("Erro ao excluir c\xe1lculo.")}};return d?(0,t.jsx)(r.A,{children:(0,t.jsx)("div",{className:"min-h-screen bg-background p-4",children:(0,t.jsx)("div",{className:"max-w-4xl mx-auto space-y-6",children:(0,t.jsx)("div",{className:"text-center py-12",children:(0,t.jsx)("p",{className:"text-muted-foreground",children:"Carregando hist\xf3rico..."})})})})}):(0,t.jsx)(r.A,{children:(0,t.jsx)("div",{className:"min-h-screen bg-background p-4",children:(0,t.jsx)("div",{className:"max-w-4xl mx-auto space-y-6",children:(0,t.jsxs)("div",{className:"animate-in fade-in slide-in-from-top-2 duration-300",children:[(0,t.jsx)(b(),{href:"/",children:(0,t.jsxs)(i.$,{variant:"ghost",className:"mb-4 pl-0 focus:ring-2 focus:ring-primary focus:ring-offset-2","aria-label":"Voltar para a p\xe1gina inicial",children:[(0,t.jsx)(p.A,{className:"mr-2 h-4 w-4","aria-hidden":"true"}),"Voltar"]})}),(0,t.jsxs)(n.Zp,{children:[(0,t.jsxs)(n.aR,{children:[(0,t.jsxs)(n.ZB,{ref:y,tabIndex:-1,className:"flex items-center gap-2 focus:outline-none",children:[(0,t.jsx)(g.A,{className:"h-6 w-6 text-primary","aria-hidden":"true"}),"Hist\xf3rico de Opera\xe7\xf5es"]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Visualize seus c\xe1lculos e fechamentos anteriores"})]}),(0,t.jsx)(n.Wu,{children:(0,t.jsxs)(m,{defaultValue:"calculations",className:"w-full",children:[(0,t.jsxs)(u,{className:"grid w-full grid-cols-2",children:[(0,t.jsxs)(x,{value:"calculations",className:"flex items-center gap-2",children:[(0,t.jsx)(g.A,{className:"h-4 w-4"}),"C\xe1lculos (",a.length,")"]}),(0,t.jsxs)(x,{value:"closings",className:"flex items-center gap-2",children:[(0,t.jsx)(j.A,{className:"h-4 w-4"}),"Fechamentos (",e.length,")"]})]}),(0,t.jsx)(h,{value:"calculations",className:"space-y-4 mt-6",children:0===a.length?(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)(g.A,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Nenhum c\xe1lculo encontrado"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:"Seus c\xe1lculos aparecer\xe3o aqui ap\xf3s o primeiro uso"})]}):(0,t.jsx)("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:a.map((e,s)=>(0,t.jsx)(n.Zp,{className:"animate-in fade-in slide-in-from-left-2 duration-300",style:{animationDelay:"".concat(50*s,"ms")},children:(0,t.jsxs)(n.Wu,{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:C(e.date)}),(0,t.jsxs)("div",{className:"flex gap-4 text-sm ".concat(e.payment>0?"":"flex-col"),children:[(0,t.jsxs)("span",{children:["Total: ",k(e.total)]}),e.payment>0&&(0,t.jsxs)("span",{children:["Pago: ",k(e.payment)]})]}),e.customerContribution>0&&(0,t.jsx)("div",{className:"flex gap-4 text-sm",children:(0,t.jsxs)("span",{className:"text-green-600",children:["Cliente ajudou:"," ",k(e.customerContribution)]})})]}),(0,t.jsx)(i.$,{variant:"ghost",size:"sm",onClick:()=>e.id&&A(e.id),className:"text-destructive hover:text-destructive","aria-label":"Excluir c\xe1lculo",children:(0,t.jsx)(N.A,{className:"h-4 w-4"})})]}),(0,t.jsx)("div",{className:"flex justify-between items-center",children:(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsxs)("p",{className:"font-medium",children:["Troco: ",k(e.change)]}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-1",children:[e.breakdown.slice(0,3).map((e,s)=>(0,t.jsxs)(l.E,{variant:"secondary",className:"text-xs",children:[e.denomination.label,":"," ",e.count]},s)),e.breakdown.length>3&&(0,t.jsxs)(l.E,{variant:"outline",className:"text-xs",children:["+",e.breakdown.length-3," mais"]})]})]})})]})},e.id))})}),(0,t.jsx)(h,{value:"closings",className:"space-y-4 mt-6",children:0===e.length?(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)(j.A,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Nenhum fechamento encontrado"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:"Seus fechamentos aparecer\xe3o aqui ap\xf3s o primeiro uso"})]}):(0,t.jsx)("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:e.map((e,s)=>(0,t.jsx)(n.Zp,{className:"animate-in fade-in slide-in-from-left-2 duration-300",style:{animationDelay:"".concat(50*s,"ms")},children:(0,t.jsxs)(n.Wu,{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:C(e.date)}),(0,t.jsxs)("p",{className:"font-medium",children:["Operador:"," ",e.operatorName||"N\xe3o informado"]}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Total: ",k(e.total)]})]}),(0,t.jsx)(i.$,{variant:"ghost",size:"sm",onClick:()=>e.id&&E(e.id),className:"text-destructive hover:text-destructive","aria-label":"Excluir fechamento",children:(0,t.jsx)(N.A,{className:"h-4 w-4"})})]}),e.notes&&(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Observa\xe7\xf5es: ",e.notes]})]})},e.id))})})]})})]})]})})})})}},8464:(e,s,a)=>{Promise.resolve().then(a.bind(a,6219))}},e=>{var s=s=>e(e.s=s);e.O(0,[514,906,650,777,179,441,684,358],()=>s(8464)),_N_E=e.O()}]);